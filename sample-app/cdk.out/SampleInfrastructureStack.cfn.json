SYNTHESIS_DEBUG: live_lambda_context_value: true
SYNTHESIS_DEBUG: props?.live_lambda_enabled: true
SYNTHESIS_DEBUG: 최종 enable_live_tunnel: true
SYNTHESIS_DEBUG: my_url_lambda seems OK before tunnel. ARN: ${Token[TOKEN.36]}
SYNTHESIS_DEBUG: Attempting 'new LiveLambdaTunnel("MyUrlLambdaTunnel", ...)'
LiveLambdaTunnel (MyUrlLambdaTunnel) CONSTRUCTOR_ENTRY. live_mode_active: true, lambda_to_proxy defined: true
LiveLambdaTunnel (MyUrlLambdaTunnel): Live mode is ACTIVE. Stubbing ${Token[TOKEN.35]}.
SYNTHESIS_DEBUG: 'new LiveLambdaTunnel' completed.
SYNTHESIS_DEBUG: my_url_lambda_tunnel.stub_lambda ARN (if created): ${Token[TOKEN.69]}
SYNTHESIS_DEBUG: my_url_lambda_tunnel.original_lambda ARN: undefined
SYNTHESIS_DEBUG: my_url_lambda_tunnel.active_lambda_target ARN: ${Token[TOKEN.69]}
SYNTHESIS_DEBUG: target_lambda_for_function_url is now directly from tunnel.active_lambda_target ARN: ${Token[TOKEN.69]}
Resources:
  MessageQueue7A3BF959:
    Type: AWS::SQS::Queue
    Properties:
      VisibilityTimeout: 300
    UpdateReplacePolicy: Delete
    DeletionPolicy: Delete
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MessageQueue/Resource
  MyUrlLambdaServiceRole8810716E:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambda/ServiceRole/Resource
  MyUrlLambdaServiceRoleDefaultPolicy200644FD:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - sqs:SendMessage
              - sqs:GetQueueAttributes
              - sqs:GetQueueUrl
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - MessageQueue7A3BF959
                - Arn
        Version: "2012-10-17"
      PolicyName: MyUrlLambdaServiceRoleDefaultPolicy200644FD
      Roles:
        - Ref: MyUrlLambdaServiceRole8810716E
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambda/ServiceRole/DefaultPolicy/Resource
  MyUrlLambda947A2956:
    Type: AWS::Lambda::Function
    Properties:
      Architectures:
        - arm64
      Code:
        S3Bucket: cdk-hnb659fds-assets-942189704687-us-west-1
        S3Key: 84d1f0b785f18d67c011acf41b852ce499c1ae7914a5e14d1aae6a523d5bff6c.zip
      Environment:
        Variables:
          NODE_OPTIONS: --enable-source-maps
          SQS_QUEUE_URL:
            Ref: MessageQueue7A3BF959
      Handler: index.handler
      Role:
        Fn::GetAtt:
          - MyUrlLambdaServiceRole8810716E
          - Arn
      Runtime: nodejs20.x
    DependsOn:
      - MyUrlLambdaServiceRoleDefaultPolicy200644FD
      - MyUrlLambdaServiceRole8810716E
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambda/Resource
      aws:asset:path: /Users/sidney/boundless/live-lambda/sample-app/cdk.out/asset.84d1f0b785f18d67c011acf41b852ce499c1ae7914a5e14d1aae6a523d5bff6c
      aws:asset:is-bundled: true
      aws:asset:property: Code
  LiveLambdaEventApi91DD40F3:
    Type: AWS::AppSync::Api
    Properties:
      EventConfig:
        AuthProviders:
          - AuthType: AWS_IAM
        ConnectionAuthModes:
          - AuthType: AWS_IAM
        DefaultPublishAuthModes:
          - AuthType: AWS_IAM
        DefaultSubscribeAuthModes:
          - AuthType: AWS_IAM
      Name: live-lambda-events-SampleInfrastructureStack
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/LiveLambdaEventApi/Resource
  MyUrlLambdaTunnelStubProxyLambdaServiceRoleECAF2AE1:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambdaTunnel/StubProxyLambda/ServiceRole/Resource
  MyUrlLambdaTunnelStubProxyLambdaServiceRoleDefaultPolicyB9C4AF64:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action: appsync:EventPublish
            Effect: Allow
            Resource:
              Fn::Join:
                - ""
                - - "arn:aws:appsync:"
                  - Ref: AWS::Region
                  - ":"
                  - Ref: AWS::AccountId
                  - :apis/
                  - Fn::GetAtt:
                      - LiveLambdaEventApi91DD40F3
                      - ApiId
                  - /channelNamespace/liveLambda
        Version: "2012-10-17"
      PolicyName: MyUrlLambdaTunnelStubProxyLambdaServiceRoleDefaultPolicyB9C4AF64
      Roles:
        - Ref: MyUrlLambdaTunnelStubProxyLambdaServiceRoleECAF2AE1
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambdaTunnel/StubProxyLambda/ServiceRole/DefaultPolicy/Resource
  MyUrlLambdaTunnelStubProxyLambdaCAB56BDD:
    Type: AWS::Lambda::Function
    Properties:
      Architectures:
        - arm64
      Code:
        S3Bucket: cdk-hnb659fds-assets-942189704687-us-west-1
        S3Key: 9aa696912d754bfdcaed9978c7818b17a11a9bd976d1fc04a509c3d0accd20df.zip
      Environment:
        Variables:
          APPSYNC_EVENT_API_URL:
            Fn::Join:
              - ""
              - - https://
                - Fn::GetAtt:
                    - LiveLambdaEventApi91DD40F3
                    - Dns.Http
                - /event
          APPSYNC_CHANNEL_NAMESPACE: liveLambda
          ORIGINAL_FUNCTION_ARN:
            Fn::GetAtt:
              - MyUrlLambda947A2956
              - Arn
      Handler: index.handler
      MemorySize: 256
      Role:
        Fn::GetAtt:
          - MyUrlLambdaTunnelStubProxyLambdaServiceRoleECAF2AE1
          - Arn
      Runtime: nodejs20.x
      Timeout: 30
    DependsOn:
      - MyUrlLambdaTunnelStubProxyLambdaServiceRoleDefaultPolicyB9C4AF64
      - MyUrlLambdaTunnelStubProxyLambdaServiceRoleECAF2AE1
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambdaTunnel/StubProxyLambda/Resource
      aws:asset:path: /Users/sidney/boundless/live-lambda/sample-app/cdk.out/asset.9aa696912d754bfdcaed9978c7818b17a11a9bd976d1fc04a509c3d0accd20df
      aws:asset:is-bundled: true
      aws:asset:property: Code
  MyUrlLambdaTunnelStubProxyLambdainvokefunctionurl1A1BBDA0:
    Type: AWS::Lambda::Permission
    Properties:
      Action: lambda:InvokeFunctionUrl
      FunctionName:
        Fn::GetAtt:
          - MyUrlLambdaTunnelStubProxyLambdaCAB56BDD
          - Arn
      FunctionUrlAuthType: NONE
      Principal: "*"
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambdaTunnel/StubProxyLambda/invoke-function-url
  MyUrlLambdaLiveSwitchUrl20CBA9C2:
    Type: AWS::Lambda::Url
    Properties:
      AuthType: NONE
      Cors:
        AllowHeaders:
          - "*"
        AllowMethods:
          - "*"
        AllowOrigins:
          - "*"
      TargetFunctionArn:
        Fn::GetAtt:
          - MyUrlLambdaTunnelStubProxyLambdaCAB56BDD
          - Arn
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/MyUrlLambdaLiveSwitchUrl/Resource
  SqsMessageProcessorLambdaServiceRoleA5ECB266:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Statement:
          - Action: sts:AssumeRole
            Effect: Allow
            Principal:
              Service: lambda.amazonaws.com
        Version: "2012-10-17"
      ManagedPolicyArns:
        - Fn::Join:
            - ""
            - - "arn:"
              - Ref: AWS::Partition
              - :iam::aws:policy/service-role/AWSLambdaBasicExecutionRole
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/SqsMessageProcessorLambda/ServiceRole/Resource
  SqsMessageProcessorLambdaServiceRoleDefaultPolicy1B5D5AB1:
    Type: AWS::IAM::Policy
    Properties:
      PolicyDocument:
        Statement:
          - Action:
              - sqs:ReceiveMessage
              - sqs:ChangeMessageVisibility
              - sqs:GetQueueUrl
              - sqs:DeleteMessage
              - sqs:GetQueueAttributes
            Effect: Allow
            Resource:
              Fn::GetAtt:
                - MessageQueue7A3BF959
                - Arn
        Version: "2012-10-17"
      PolicyName: SqsMessageProcessorLambdaServiceRoleDefaultPolicy1B5D5AB1
      Roles:
        - Ref: SqsMessageProcessorLambdaServiceRoleA5ECB266
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/SqsMessageProcessorLambda/ServiceRole/DefaultPolicy/Resource
  SqsMessageProcessorLambdaA898F567:
    Type: AWS::Lambda::Function
    Properties:
      Architectures:
        - arm64
      Code:
        S3Bucket: cdk-hnb659fds-assets-942189704687-us-west-1
        S3Key: 12bbd4bdd01f0d9b98ce0cba7f231196b7b89c35da3e37d495c6f05522b66d5f.zip
      Environment:
        Variables:
          NODE_OPTIONS: --enable-source-maps
      Handler: index.handler
      Role:
        Fn::GetAtt:
          - SqsMessageProcessorLambdaServiceRoleA5ECB266
          - Arn
      Runtime: nodejs20.x
    DependsOn:
      - SqsMessageProcessorLambdaServiceRoleDefaultPolicy1B5D5AB1
      - SqsMessageProcessorLambdaServiceRoleA5ECB266
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/SqsMessageProcessorLambda/Resource
      aws:asset:path: /Users/sidney/boundless/live-lambda/sample-app/cdk.out/asset.12bbd4bdd01f0d9b98ce0cba7f231196b7b89c35da3e37d495c6f05522b66d5f
      aws:asset:is-bundled: true
      aws:asset:property: Code
  SqsMessageProcessorLambdaSqsEventSourceSampleInfrastructureStackMessageQueue5A6EAEBED3E6CA77:
    Type: AWS::Lambda::EventSourceMapping
    Properties:
      BatchSize: 10
      EventSourceArn:
        Fn::GetAtt:
          - MessageQueue7A3BF959
          - Arn
      FunctionName:
        Ref: SqsMessageProcessorLambdaA898F567
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/SqsMessageProcessorLambda/SqsEventSource:SampleInfrastructureStackMessageQueue5A6EAEBE/Resource
  CDKMetadata:
    Type: AWS::CDK::Metadata
    Properties:
      Analytics: v2:deflate64:H4sIAAAAAAAA/2WPTW/CMAyGfwv31IOyHXYsiN321WrnygSD3I80qxMQivLfpwS2y06P/b72K7uE1fMTLBd4kUIf+mLgPYTGoe4VXqQN8i0QPj15UtujyUVUA477A7ZmOlAn8Jbx4o12PBnFOEKopyEvZH5MA+tram9VVLJuUYScQJWgZA0br3tyGxS6x0PYHs1falqmeWSR1P3KX/OQnITdmYxrJj9rekVr2ZyS81+NCq2Vq9EQsllZToOV5RhVTZJnVT6rcXi657x7Z72LKr0MnTycyxJWj7BcdMJczN44HgnqG38A6uPUU1QBAAA=
    Metadata:
      aws:cdk:path: SampleInfrastructureStack/CDKMetadata/Default
Outputs:
  StubMyUrlLambdaArn:
    Description: ARN of the Stub Lambda for MyUrlLambda used in live mode
    Value:
      Fn::GetAtt:
        - MyUrlLambdaTunnelStubProxyLambdaCAB56BDD
        - Arn
  MessageQueueUrlCfn:
    Value:
      Ref: MessageQueue7A3BF959
  MessageQueueArnCfn:
    Value:
      Fn::GetAtt:
        - MessageQueue7A3BF959
        - Arn
  MyUrlLambdaFunctionUrl:
    Description: The Function URL for MyUrlLambda (conditionally proxied if live mode is active)
    Value:
      Fn::GetAtt:
        - MyUrlLambdaLiveSwitchUrl20CBA9C2
        - FunctionUrl
  LiveLambdaEventApiId:
    Description: The ID of the AppSync Event API for Live Lambda.
    Value:
      Fn::GetAtt:
        - LiveLambdaEventApi91DD40F3
        - ApiId
  LiveLambdaEventApiHttpEndpoint:
    Description: The HTTP endpoint for the AppSync Event API for Live Lambda.
    Value:
      Fn::Join:
        - ""
        - - https://
          - Fn::GetAtt:
              - LiveLambdaEventApi91DD40F3
              - Dns.Http
          - /event
  LiveLambdaEventApiWssEndpoint:
    Description: The WebSocket endpoint for the AppSync Event API for Live Lambda.
    Value:
      Fn::Join:
        - ""
        - - wss://
          - Fn::GetAtt:
              - LiveLambdaEventApi91DD40F3
              - Dns.Realtime
          - /event/realtime
Parameters:
  BootstrapVersion:
    Type: AWS::SSM::Parameter::Value<String>
    Default: /cdk-bootstrap/hnb659fds/version
    Description: Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]

